<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouton Web avec Design</title>

    <link rel="stylesheet" href="style.css">
    <script src="code.js" defer></script>
</head>
<body>
    <h1>Barrage intelligente</h1>
    <main>   
        <article class="data">
            <ul>
                <li>

                    <div class="DataItem">
                        <p>temperature d'eau:</p>
                        <h2 
                        id="water">00c</h2>
                    </div>
                </li>

                <li>
                    <div class="DataItem">
                        <p>pourcentage de niveau d'eau:</p>
                        <h2 id="water">00%</h2>
                    </div>
                </li>
                
                <li>
                    <div class="DataItem">
                        <p>qualite d'eau</p>
                        <h2>60%</h2>
                    </div>
                </li>


            </ul>
        </article>
        <article>
            <h2>hauteur de  barrage</h2>
            <div class="slidecontainer">
                <input type="range" min="1" max="100" value="50" class="slider" id="elever">
            </div>
            <br>
            <button onclick="send(0)">elever le barrage</button>
        </article>
    </main>
    <script>
        socket = new WebSocket("ws://192.168.1.16:81")
        connected = false;




        socket.onopen = (e) => {
            socket.send("connected yay!");
            connected = true;
        };

        socket.onclose = function (e) {
            console.log("not connected");
            connected = false;
        };
        

        socket.onmessage = function(recu){
            let parts = recu.data.split('_');

            switch (parts[0].toLowerCase()) {
            case 't':
                var temp = parts[1];
                console.log('Temperature:', temp);
                document.getElementById("temperature").innerHTML = tempera + " C"
                break;

            case 'w':
                var waterLevel = parts[1];
                console.log('Water Level:', waterLevel);
                document.getElementById("water").innerHTML = waterLevel + " %"
                break;
                
            default:
                console.error("unknown type");
            }
        }

        function send(cas) {
        if (cas==0){
            socket.send(document.getElementById("elever").value);
        }
            
        }



   </script>

</body>
</html>
